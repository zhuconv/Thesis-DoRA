2024-04-03 20:42:39,817 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Current SDK version is 0.16.5
2024-04-03 20:42:39,817 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Configure stats pid to 18222
2024-04-03 20:42:39,817 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Loading settings from /root/.config/wandb/settings
2024-04-03 20:42:39,817 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Loading settings from /zhujiajun/ThesisLoRA/repos/VeRA/instruct/wandb/settings
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Loading settings from environment variables: {}
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Applying setup settings: {'_disable_service': False}
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_setup.py:_flush():76] Inferring run settings from compute environment: {'program_relpath': 'finetune.py', 'program_abspath': '/zhujiajun/ThesisLoRA/repos/VeRA/instruct/finetune.py', 'program': '/zhujiajun/ThesisLoRA/repos/VeRA/instruct/finetune.py'}
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:_log_setup():527] Logging user logs to /zhujiajun/ThesisLoRA/repos/VeRA/instruct/wandb/offline-run-20240403_204239-k5bq2y7u/logs/debug.log
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:_log_setup():528] Logging internal logs to /zhujiajun/ThesisLoRA/repos/VeRA/instruct/wandb/offline-run-20240403_204239-k5bq2y7u/logs/debug-internal.log
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:init():567] calling init triggers
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:init():574] wandb.init called with sweep_config: {}
config: {}
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:init():617] starting backend
2024-04-03 20:42:39,818 INFO    MainThread:18222 [wandb_init.py:init():621] setting up manager
2024-04-03 20:42:39,819 INFO    MainThread:18222 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-04-03 20:42:39,820 INFO    MainThread:18222 [wandb_init.py:init():629] backend started and connected
2024-04-03 20:42:39,822 INFO    MainThread:18222 [wandb_init.py:init():721] updated telemetry
2024-04-03 20:42:39,822 INFO    MainThread:18222 [wandb_init.py:init():754] communicating run to backend with 90.0 second timeout
2024-04-03 20:42:39,825 INFO    MainThread:18222 [wandb_init.py:init():805] starting run threads in backend
2024-04-03 20:42:55,300 INFO    MainThread:18222 [wandb_run.py:_console_start():2323] atexit reg
2024-04-03 20:42:55,300 INFO    MainThread:18222 [wandb_run.py:_redirect():2178] redirect: wrap_raw
2024-04-03 20:42:55,301 INFO    MainThread:18222 [wandb_run.py:_redirect():2243] Wrapping output streams.
2024-04-03 20:42:55,301 INFO    MainThread:18222 [wandb_run.py:_redirect():2268] Redirects installed.
2024-04-03 20:42:55,301 INFO    MainThread:18222 [wandb_init.py:init():848] run started, returning control to user process
2024-04-03 20:42:55,302 INFO    MainThread:18222 [wandb_run.py:_config_callback():1347] config_cb None None {'seed_val': 42}
2024-04-03 20:42:55,302 INFO    MainThread:18222 [wandb_run.py:_config_callback():1347] config_cb None None {'custom_mode': 'lora', 'custom_submode': 'none', 'custom_scaling': 0, 'shared_dim': 11008, 'shared_uv': 0, 'dynamic_uv': 0, 'custom_d_init': 1.0, 'custom_sqrt_a': 5, 'custom_disable_identity': True, 'init_type': 1, 'd_init_type': 94, 'lora_r': 64, 'lora_alpha': 1, 'target_modules': 'no_head', 'task': 'instruct', 'dataset': 'alpaca-clean', 'train_samples': 10000, 'metric_samples': 100, 'eval_samples': 64, 'epochs': 1, 'train_bs': 4, 'metric_bs': 10, 'eval_bs': 4, 'eval_steps': 20, 'logging_steps': 1, 'metrics_enabled': 0, 'seed': 42, 'model': 'meta-llama/Llama-2-7b-hf', 'quantize': True, 'lr': 0.0004, 'wd': 0.0, 'accumulation_steps': 4, 'generate_samples': True, 'warmup_ratio': 0.1, 'lr_scheduler_type': 'cosine', 'run_project': 'default', 'run_name': 'default', 'run_group': 'default', 'init_job_id': 0, 'offline': True}
2024-04-03 20:42:55,302 INFO    MainThread:18222 [wandb_run.py:_config_callback():1347] config_cb None None {'job_id': '0', 'init_job_id': 0}
2024-04-03 20:43:23,524 WARNING MsgRouterThr:18222 [router.py:message_loop():77] message_loop has been closed
